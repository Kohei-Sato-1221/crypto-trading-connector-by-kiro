# 実装計画

- [x] 1. フロントエンドをモックデータで動作させる
  - 取引履歴ページの基本レイアウトを実装
  - 統計カード（総利益、約定数）コンポーネントを作成
  - 取引ログコンポーネントを作成
  - フィルターコントロール（時間、資産）を実装
  - モックデータを使用してページ全体を動作させる
  - _要件: 1.1, 1.4, 2.1, 2.2, 3.1, 4.1, 6.1_

- [x] 1.1 フロントエンドコンポーネントのプロパティテストを作成
  - **プロパティ 8: 数値フォーマットの正確性**
  - **検証対象: 要件 1.5**

- [x] 1.2 フロントエンドコンポーネントのプロパティテストを作成
  - **プロパティ 9: タイムスタンプフォーマットの正確性**
  - **検証対象: 要件 2.5**

- [x] 2. 必要なAPIエンドポイントをピックアップ
  - 取引統計取得API（GET /api/v1/trade-history/statistics）を定義
  - 取引ログ取得API（GET /api/v1/trade-history/transactions）を定義
  - フィルターとページネーションパラメータを定義
  - _要件: 1.1, 2.1, 3.2, 4.2, 6.2_

- [x] 3. OpenAPI仕様を修正
  - 取引履歴関連のエンドポイントをopenapi.yamlに追加
  - リクエスト・レスポンススキーマを定義
  - エラーレスポンスを定義
  - _要件: 全要件に対応するAPI仕様_

- [x] 4. バックエンドコード生成
  - OpenAPI仕様からGoのモデルとインターフェースを生成
  - 生成されたコードを確認・調整
  - _要件: API仕様に基づく型安全なコード_

- [-] 5. バックエンド実装
- [-] 5.1 データベースアクセス層を実装
  - TradeHistoryRepositoryインターフェースを実装
  - 取引データ取得クエリを実装
  - 利益計算クエリを実装
  - フィルタリングとページネーション機能を実装
  - _要件: 1.1, 1.2, 2.1, 3.2, 4.2, 6.2_

- [ ] 5.2 データベース層のプロパティテストを作成
  - **プロパティ 3: 資産フィルタリングの正確性**
  - **検証対象: 要件 3.2, 3.3, 3.4**

- [ ] 5.3 データベース層のプロパティテストを作成
  - **プロパティ 4: 時間フィルタリングの正確性**
  - **検証対象: 要件 4.2, 4.3, 4.4, 4.5**

- [ ]* 5.4 データベース層のプロパティテストを作成
  - **プロパティ 6: データ関連付けの整合性**
  - **検証対象: 要件 2.1**

- [ ] 5.5 ビジネスロジック層を実装
  - TradeHistoryServiceインターフェースを実装
  - 利益計算ロジックを実装（小数点第1位まで四捨五入）
  - 統計計算ロジックを実装
  - フィルター処理ロジックを実装
  - _要件: 1.1, 1.2, 1.4, 2.4, 3.3, 4.3_

- [ ] 5.6 ビジネスロジック層のプロパティテストを作成
  - **プロパティ 1: 利益計算の正確性**
  - **検証対象: 要件 1.2, 2.4**

- [ ] 5.7 ビジネスロジック層のプロパティテストを作成
  - **プロパティ 2: 統計の一貫性**
  - **検証対象: 要件 1.1, 1.4**

- [ ] 5.8 ビジネスロジック層のプロパティテストを作成
  - **プロパティ 5: 取引情報の完全性**
  - **検証対象: 要件 2.2, 2.3**

- [ ] 5.9 HTTPハンドラー層を実装
  - TradeHistoryHandlerを実装
  - リクエストバリデーションを実装
  - エラーハンドリングを実装
  - レスポンス形成を実装
  - _要件: 5.4（エラーハンドリング）_

- [ ] 5.10 HTTPハンドラー層のプロパティテストを作成
  - **プロパティ 7: ページネーション時のフィルター維持**
  - **検証対象: 要件 6.2, 6.3**

- [ ] 5.11 バックエンド統合テストを作成
  - API エンドポイントの統合テスト
  - データベースとの統合テスト
  - エラーケースのテスト
  - _要件: 全バックエンド要件_

- [ ] 6. チェックポイント - バックエンドテストの確認
  - すべてのテストが通ることを確認し、問題があれば質問する

- [ ] 7. フロントエンドのAPI統合実装
- [ ] 7.1 取引履歴データ取得コンポーザブルを実装
  - useTradeHistoryコンポーザブルを作成
  - API呼び出しロジックを実装
  - エラーハンドリングとローディング状態を実装
  - _要件: 5.1, 5.3, 5.4_

- [ ] 7.2 フィルター機能を実装
  - 資産フィルター（全資産、BTC、ETH）を実装
  - 時間フィルター（全期間、過去7日間）を実装
  - フィルター状態管理を実装
  - _要件: 3.1, 3.2, 4.1, 4.2_

- [ ] 7.3 ページネーション機能を実装
  - 「古い取引を表示」ボタンを実装
  - 追加データ読み込み機能を実装
  - フィルター状態の維持を実装
  - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 7.4 レスポンシブデザインを実装
  - モバイル対応レイアウトを実装
  - タッチ操作対応を実装
  - 既存デザインシステムとの一貫性を確保
  - _要件: 5.2, 5.5_

- [ ]* 7.5 フロントエンド統合テストを作成
  - ユーザーフローのE2Eテスト
  - フィルタリングとページネーションのテスト
  - エラーハンドリングのテスト
  - _要件: 全フロントエンド要件_

- [ ] 8. 最終チェックポイント - 全テストの確認
  - すべてのテストが通ることを確認し、問題があれば質問する