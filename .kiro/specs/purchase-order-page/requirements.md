# 要件定義書

## はじめに

本ドキュメントは、暗号通貨の購入注文を行うための注文ページの要件を定義します。このページは、リアルタイムの価格情報、過去の価格チャート、および様々な入力方法を備えた直感的な注文フォームを提供し、暗号通貨の購入を容易にします。

## 用語集

- **システム**: 注文ページアプリケーション
- **ユーザー**: 暗号通貨を購入したい人
- **通貨ペア**: 2つの通貨で構成される取引ペア（例：BTC/JPY、ETH/JPY）
- **指値注文**: 指定した価格またはそれより良い価格で購入する注文
- **利用可能残高**: ユーザーが取引に利用できる法定通貨（JPY）の金額
- **丸め価格**: 現在価格を一定の基準で丸めた値（例：BTC 14,062,621→14,000,000、ETH 485,318→480,000）
- **注文フォーム**: ユーザーが注文詳細を入力するインターフェースコンポーネント
- **価格チャート**: 過去の価格データの視覚的表現
- **時間フィルター**: 表示する価格データの時間範囲を選択するコントロール

## 要件

### 要件1

**ユーザーストーリー:** ユーザーとして、異なる通貨ペアを選択したい。そうすることで、異なる暗号通貨の価格を表示し、注文を出すことができる。

#### 受入基準

1. ページが読み込まれたとき、システムはデフォルトで選択された通貨ペアとしてBTC/JPYを表示しなければならない
2. ユーザーが通貨ペアタブをクリックしたとき、システムは選択されたペアを反映して、表示される価格、チャート、注文フォームを更新しなければならない
3. 通貨ペアが選択されたとき、システムはアクティブなタブを視覚的に強調表示しなければならない

### 要件2

**ユーザーストーリー:** ユーザーとして、現在価格と24時間の変動を表示したい。そうすることで、情報に基づいた取引判断ができる。

#### 受入基準

1. ページが価格情報を表示するとき、システムは現在価格を適切なフォーマットでJPYで表示しなければならない
2. 24時間の変動がプラスのとき、システムは変動率を緑色で上向き矢印アイコンとともに表示しなければならない
3. 24時間の変動がマイナスのとき、システムは変動率を赤色で下向き矢印アイコンとともに表示しなければならない
4. 価格データが更新されたとき、システムはページのリロードを必要とせずに表示値を更新しなければならない

### 要件3

**ユーザーストーリー:** ユーザーとして、異なる時間範囲で過去の価格チャートを表示したい。そうすることで、注文を出す前に価格トレンドを分析できる。

#### 受入基準

1. ページが読み込まれたとき、システムはデフォルトの時間範囲として7D（7日間）で価格チャートを表示しなければならない
2. ユーザーが時間フィルター（1H、24H、7D、30D、1Y）を選択したとき、システムは選択された時間範囲のデータを表示するようにチャートを更新しなければならない
3. 時間フィルターがアクティブなとき、システムは選択されたフィルターボタンを視覚的に強調表示しなければならない
4. チャートデータが表示されるとき、システムはx軸に日付ラベルと価格トレンドラインを表示しなければならない

### 要件4

**ユーザーストーリー:** ユーザーとして、指値注文で暗号通貨を購入したい。そうすることで、希望する価格で注文を出すことができる。

#### 受入基準

1. 注文フォームが読み込まれたとき、システムは指値注文タイプのみをサポートしなければならない
2. 注文フォームが表示されたとき、システムは価格入力フィールドを有効にしなければならない

### 要件5

**ユーザーストーリー:** ユーザーとして、注文の価格と数量を入力したい。そうすることで、購入したいものを正確に指定できる。

#### 受入基準

1. 注文フォームが読み込まれたとき、システムは現在価格を丸めた値を価格フィールドのデフォルト値として設定しなければならない
2. 注文フォームが読み込まれたとき、システムはBTC/JPYの場合は0.001、ETH/JPYの場合は0.01を数量フィールドのデフォルト値として設定しなければならない
3. ユーザーが価格値を入力したとき、システムは適切な小数精度で数値入力を受け付けなければならない
4. ユーザーが数量値を入力したとき、システムは暗号通貨単位の適切な小数精度で数値入力を受け付けなければならない
5. ユーザーが数量の増加ボタンをクリックしたとき、システムはBTC/JPYの場合は0.001、ETH/JPYの場合は0.01ずつ数量を増加させなければならない
6. ユーザーが数量の減少ボタンをクリックしたとき、システムはBTC/JPYの場合は0.001、ETH/JPYの場合は0.01ずつ数量を減少させなければならない
7. 数量が最小値未満に減少したとき、システムは負の値を防ぎ、最小値を維持しなければならない

### 要件6

**ユーザーストーリー:** ユーザーとして、現在価格の割引価格を素早く設定したい。そうすることで、手動計算なしで簡単に指値価格を設定できる。

#### 受入基準

1. ユーザーが99%ボタンをクリックしたとき、システムは現在価格の99%を計算して価格フィールドに設定しなければならない
2. ユーザーが97%ボタンをクリックしたとき、システムは現在価格の97%を計算して価格フィールドに設定しなければならない
3. ユーザーが95%ボタンをクリックしたとき、システムは現在価格の95%を計算して価格フィールドに設定しなければならない
4. 割引価格ボタンがクリックされたとき、システムはそれに応じて推定合計を更新しなければならない

### 要件7

**ユーザーストーリー:** ユーザーとして、利用可能残高と推定合計を確認したい。そうすることで、注文を出す前に十分な資金があることを確認できる。

#### 受入基準

1. 注文フォームが表示されたとき、システムはユーザーの利用可能残高をJPYで表示しなければならない
2. 価格または数量が変更されたとき、システムは推定合計をリアルタイムで再計算して表示しなければならない
3. 推定合計が利用可能残高を超えたとき、システムは警告を表示するか注文ボタンを無効にしなければならない
4. 金額を表示するとき、システムは適切な桁区切りと通貨記号で金額をフォーマットしなければならない

### 要件8

**ユーザーストーリー:** ユーザーとして、購入注文を出したい。そうすることで、暗号通貨を購入できる。

#### 受入基準

1. ユーザーが購入注文ボタンをクリックしたとき、システムはすべての入力フィールドを検証しなければならない
2. すべての検証が通過したとき、システムはバックエンドAPIに注文を送信しなければならない
3. 注文が正常に出されたとき、システムは成功確認を表示しなければならない
4. 注文が失敗したとき、システムは詳細を含むエラーメッセージを表示しなければならない
5. 必須フィールドが空または無効なとき、システムは注文送信を防ぎ、検証エラーを強調表示しなければならない

### 要件9

**ユーザーストーリー:** ユーザーとして、インターフェースがレスポンシブでモバイルフレンドリーであることを望む。そうすることで、どのデバイスからでも注文を出すことができる。

#### 受入基準

1. ページがモバイルデバイスで表示されたとき、システムは小さい画面に合わせてレイアウトを適応させなければならない
2. タッチ操作が使用されたとき、システムはタップとスワイプに適切に応答しなければならない
3. ビューポートサイズが変更されたとき、システムはすべてのコンポーネントの可読性と使いやすさを維持しなければならない
